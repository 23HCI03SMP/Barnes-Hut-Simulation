name: Build C++ Program

on: [push, pull_request]

jobs:
  build:
    runs-on: ubuntu-latest
    
    steps:
    - uses: actions/checkout@v2
    
    - name: Install Chocolatey
      run: |
        Set-ExecutionPolicy Bypass -Scope Process -Force
        iex ((New-Object System.Net.WebClient).DownloadString('https://chocolatey.org/install.ps1'))
    
    - name: Install MSYS2
      run: |
        choco install msys2 -y
        refreshenv
        
    - name: Install required packages with MSYS2
      run: |
        packman --noconfirm -S mingw-w64-x86_64-gcc mingw-w64-x86_64-gsl mingw-w64-x86_64-openmp
    
    - name: Build C++ program with g++
      run: |
        g++ -g ./src/*.cpp -o main.exe -lgsl -lgslcblas -lm -fopenmp
        
    - name: Run C++ program
      run: |
        ./main.exe
